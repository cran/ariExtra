<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Using ari to make videos</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Using <code>ari</code> to make videos</h1>



<div id="making-videos-with-ari-ari_stitch" class="section level2">
<h2>Making videos with <code>ari</code>: <code>ari_stitch</code></h2>
<p>The main workhorse of <strong><code>ari</code></strong> is the <code>ari_stitch</code> function. This function requires an ordered set of images and an ordered set of audio objects, either paths to <code>wav</code> files or <strong><code>tuneR</code></strong> Wave objects, that correspond to each image. The <code>ari_stitch</code> function sequentially “stitches” each image in the video for the duration of its corresponding audio object using <code>ffmpeg</code>. In order to use <strong><code>ari</code></strong>, one must have an <code>ffmpeg</code> installation to combine the audio and images. Other packages such as <strong><code>animation</code></strong> have a similar requirement. Moreover, on <a href="https://www.shinyapps.io/">shinyapps.io</a>, a dependency on the <strong><code>animation</code></strong> package will trigger an installation of <code>ffmpeg</code> so <strong><code>ari</code></strong> can be used on <a href="https://www.shinyapps.io/">shinyapps.io</a>. In the example below, 2 images (packaged with <strong><code>ari</code></strong>) are overlaid withe white noise for demonstration. This example also allows users to check if the output of <code>ffmpeg</code> works with a desired video player.</p>
<pre><code>#&gt; [1] TRUE</code></pre>
<p>The output is a logical indicator, but additional attributes are available, such as the path of the output file:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (ari<span class="sc">::</span><span class="fu">have_ffmpeg_exec</span>()) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">attributes</span>(result)<span class="sc">$</span>outfile)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>#&gt; [1] &quot;file13e7f1f64a00.mp4&quot;</code></pre>
<p>The video for this output can be seen at <a href="https://youtu.be/3kgaYf-EV90" class="uri">https://youtu.be/3kgaYf-EV90</a>.</p>
<p>In <strong><code>ariExtra</code></strong>, you</p>
<pre><code>#&gt; $output_file
#&gt; [1] &quot;/var/folders/1s/wrtqcpxn685_zk570bnx9_rr0000gr/T//Rtmp15aUhe/file13e7f30c683fc.md&quot;
#&gt; 
#&gt; $original_images
#&gt; [1] &quot;/Users/johnmuschelli/Library/R/4.0/library/ari/test/mab1.png&quot;
#&gt; [2] &quot;/Users/johnmuschelli/Library/R/4.0/library/ari/test/mab2.png&quot;
#&gt; 
#&gt; $images
#&gt; [1] &quot;/private/var/folders/1s/wrtqcpxn685_zk570bnx9_rr0000gr/T/Rtmp15aUhe/file13e7f30c683fc_files/slide_00001.png&quot;
#&gt; [2] &quot;/private/var/folders/1s/wrtqcpxn685_zk570bnx9_rr0000gr/T/Rtmp15aUhe/file13e7f30c683fc_files/slide_00002.png&quot;
#&gt; 
#&gt; $script
#&gt; [1] &quot;hey&quot; &quot;ho&quot; 
#&gt; 
#&gt; $use_knitr
#&gt; [1] FALSE
#&gt;  [1] &quot;---&quot;                                                              
#&gt;  [2] &quot;output:&quot;                                                          
#&gt;  [3] &quot;  ariExtra::ari_document:&quot;                                        
#&gt;  [4] &quot;    verbose: yes&quot;                                                 
#&gt;  [5] &quot;---&quot;                                                              
#&gt;  [6] &quot;&quot;                                                                 
#&gt;  [7] &quot;&quot;                                                                 
#&gt;  [8] &quot;----------&quot;                                                       
#&gt;  [9] &quot;&quot;                                                                 
#&gt; [10] &quot;&lt;!--hey--&gt;&quot;                                                       
#&gt; [11] &quot;![](/Users/johnmuschelli/Library/R/4.0/library/ari/test/mab1.png)&quot;
#&gt; [12] &quot;&quot;                                                                 
#&gt; [13] &quot;&quot;                                                                 
#&gt; [14] &quot;----------&quot;                                                       
#&gt; [15] &quot;&quot;                                                                 
#&gt; [16] &quot;&lt;!--ho--&gt;&quot;                                                        
#&gt; [17] &quot;![](/Users/johnmuschelli/Library/R/4.0/library/ari/test/mab2.png)&quot;
#&gt; [18] &quot;&quot;</code></pre>
</div>
<div id="synthesizer-authentication" class="section level2">
<h2>Synthesizer authentication</h2>
<p>The above example uses <code>tuneR::noise()</code> to generate audio and to show that any audio object can be used with <strong><code>ari</code></strong>. In most cases however, <strong><code>ari</code></strong> is most useful when combined with synthesizing audio using a text-to-speech system. Though one can generate the spoken audio in many ways, such as fitting a custom deep learning model, we will focus on using the aforementioned services (e.g. Amazon Polly) as they have straightforward public web APIs. One obstacle in using such services is that users must go through steps to provide authentication, whereas most of these APIs and the associated R packages do not allow for interactive authentication such as OAuth.</p>
<p>The <strong><code>text2speech</code></strong> package provides a unified interface to these 3 text-to-speech services, and we will focus on Amazon Polly and its authentication requirements. Polly is authenticated using the <strong><code>aws.signature</code></strong> package. The <strong><code>aws.signature</code></strong> documentation provides options and steps to create the relevant credentials; we have also provided an additional <a href="https://seankross.com/2017/05/02/Access-Amazon-Web-Services-in-R.html">tutorial</a>. Essentially, the user must sign up for the service and retrieve public and private API keys and put them into their R profile or other areas accessible to R. Running <code>text2speech::tts_auth(service = &quot;amazon&quot;)</code> will indicate if authentication was successful (if using a different service, change the <code>service</code> argument). NB: The APIs are generally paid services, but many have free tiers or limits, such as Amazon Polly’s free tier for the first year (<a href="https://aws.amazon.com/polly/pricing/" class="uri">https://aws.amazon.com/polly/pricing/</a>). <!-- NB - nota bene --></p>
</div>
<div id="creating-speech-from-text-ari_spin" class="section level2">
<h2>Creating Speech from Text: <code>ari_spin</code></h2>
<p>After Polly has been authenticated, videos can be created using the <code>ari_spin</code> function with an ordered set of images and a corresponding ordered set of text strings. This text is the “script” that is spoken over the images to create the output video. The number of elements in the text needs to be equal to the number of images.</p>
<div id="creating-videos-from-r-markdown-documents" class="section level3">
<h3>Creating Videos from R Markdown Documents</h3>
<p>Many R users have experience creating slide decks with R Markdown, for example using the <strong><code>rmarkdown</code></strong> or <strong><code>xaringan</code></strong> packages. In <strong><code>ari</code></strong>, the HTML slides are rendered using <strong><code>webshot</code></strong> and the script is located in HTML comments (i.e. between <code>&lt;!--</code> and <code>--&gt;</code>). For example, in the file <code>ari_comments.Rmd</code> included in <strong><code>ari</code></strong>, which is an <code>ioslides</code> type of R Markdown slide deck, we have the last slide:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">readLines</span>(<span class="fu">ari_example</span>(<span class="st">&quot;ari_comments.Rmd&quot;</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(x[ x <span class="sc">!=</span> <span class="st">&quot;&quot;</span>], <span class="dv">4</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;## Conclusion&quot;                                             </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2] &quot;&lt;!--&quot;                                                      </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3] &quot;Thank you for watching this video and good luck using Ari!&quot;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4] &quot;--&gt;&quot;</span></span></code></pre></div>
<p>so that the first words spoken on that slide are <code>&quot;Thank you&quot;</code>. This setup allows for one plain text, version-controllable, integrated document that can reproducibly generate a video. We believe these features allow creators to make agile videos, that can easily be updated with new material or changed when errors or typos are found. Moreover, this framework provides an opportunity to translate videos into multiple languages, we will discuss in the future directions.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a video from an R Markdown file with comments and slides</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>result <span class="ot">=</span> ariExtra<span class="sc">::</span><span class="fu">rmd_to_ari</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  ari<span class="sc">::</span><span class="fu">ari_example</span>(<span class="st">&quot;ari_comments.Rmd&quot;</span>),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">capture_method =</span> <span class="st">&quot;iterative&quot;</span>, <span class="at">open =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>The output video is located at <a href="https://youtu.be/rv9fg_qsqc0" class="uri">https://youtu.be/rv9fg_qsqc0</a>. In our experience with several users we have found that some HTML slides take more or less time to render when using <strong><code>webshot</code></strong>; for example they may be tinted with gray because they are in the middle of a slide transition when the image of the slide is captured. Therefore we provide the <code>delay</code> argument in <code>ari_narrate</code> which is passed to <strong><code>webshot</code></strong>. This can resolve these issues by allowing more time for the page to fully render, however this means it may take for more time to create each video. We also provide the argument <code>capture_method</code> to allow for finely-tuned control of <code>webshot</code>. When <code>capture_method = &quot;vectorized&quot;</code>, <strong><code>webshot</code></strong> is run on the entire slide deck in a faster process, however we have experienced slide rendering issues with this setting depending on the configuration of an individual’s computer. However when <code>capture_method = &quot;iterative&quot;</code>, each slide is rendered individually in <code>webshot</code>, which solves many rendering issues, however it causes videos to be rendered more slowly.<br />
In the future, other HTML headless rendering engines (<code>webshot</code> uses <code>PhantomJS</code>) may be used if they achieve better performance, but we have found <strong><code>webshot</code></strong> to work well in most of our applications.</p>
<p>With respect to accessibility, <strong><code>ari</code></strong> encourages video creators to type out a script by design. This provides an effortless source of subtitles for people with hearing loss rather than relying on other services, such as YouTube, to provide speech-to-text subtitles. When using <code>ari_spin</code>, if the <code>subtitles</code> argument is <code>TRUE</code>, then an SRT file for subtitles will be created with the video.</p>
<p>One issue with synthesis of technical information is that changes to the script are required for Amazon Polly or other services to provide a correct pronunciation. For example, if you want the service to say “RStudio” or “<code>ggplot2</code>”, the phrases “R Studio” or “g g plot 2” must be written exactly that way in the script. These phrases will then appear in an SRT subtitle file, which may be confusing to a viewer. Thus, some post-processing of the SRT file may be needed.</p>
</div>
<div id="creating-videos-from-other-documents" class="section level3">
<h3>Creating Videos from Other Documents</h3>
<p>In order to create a video from a Google Slide deck or PowerPoint presentation, the slides should be converted to a set of images. We recommend using the PNG format for these images. In order to get the script for the video, we suggest putting the script for each slide in the speaker notes section of that slide. Several of the following features for video generation are in our package <strong><code>ariExtra</code></strong> (<a href="https://github.com/jhudsl/ariExtra" class="uri">https://github.com/jhudsl/ariExtra</a>). The speaker notes of slides can be extracted using <strong><code>rgoogleslides</code></strong> for Google Slides via the API or using <strong><code>readOffice</code></strong>/<strong><code>officer</code></strong> to read from PowerPoint documents. Google Slides can be downloaded as a PDF and converted to PNGs using the <strong><code>pdftools</code></strong> package. The <strong><code>ariExtra</code></strong> package also has a <code>pptx_notes</code> function for reading PowerPoint notes. Converting PowerPoint files to PDF can be done using LibreOffice and the <strong><code>docxtractr</code></strong> package which contains the necessary wrapper functions.</p>
<p>To demonstrate this, we use an example PowerPoint is located on Figshare (<a href="https://figshare.com/articles/presentation/Example_PowerPoint_for_ari/8865230" class="uri">https://figshare.com/articles/presentation/Example_PowerPoint_for_ari/8865230</a>). We can convert the PowerPoint to PDF, then to a set of PNG images, then extract the speaker notes.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>have_libreoffice <span class="ot">=</span> <span class="cf">function</span>() {</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">try</span>({docxtractr<span class="sc">:::</span><span class="fu">lo_assert</span>()}, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">!</span><span class="fu">inherits</span>(x, <span class="st">&quot;try-error&quot;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">have_libreoffice</span>()) {</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  pptx <span class="ot">=</span> <span class="fu">tempfile</span>(<span class="at">fileext =</span> <span class="st">&quot;.pptx&quot;</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">download.file</span>(</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">&quot;https://s3-eu-west-1.amazonaws.com/&quot;</span>, </span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;pfigshare-u-files/16252631/ari.pptx&quot;</span>),</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">destfile =</span> pptx)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">=</span> <span class="fu">try</span>({</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pptx_to_ari</span>(pptx, <span class="at">open =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  }, <span class="at">silent =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  soffice_config_issue <span class="ot">=</span> <span class="fu">inherits</span>(result, <span class="st">&quot;try-error&quot;</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (soffice_config_issue) {</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    ariExtra<span class="sc">:::</span><span class="fu">fix_soffice_library_path</span>()</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    result <span class="ot">=</span> <span class="fu">try</span>({</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">pptx_to_ari</span>(pptx, <span class="at">open =</span> <span class="cn">FALSE</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">silent =</span> <span class="cn">TRUE</span>)    </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">inherits</span>(result, <span class="st">&quot;try-error&quot;</span>)) {</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(result[<span class="fu">c</span>(<span class="st">&quot;images&quot;</span>, <span class="st">&quot;script&quot;</span>)])</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Getting Notes from PPTX</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Converting PPTX to PDF</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Converting PDF to PNGs</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Converting page 1 to /var/folders/1s/wrtqcpxn685_zk570bnx9_rr0000gr/T//Rtmp15aUhe/file13e7f4785da82.png... done!</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Converting page 2 to /var/folders/1s/wrtqcpxn685_zk570bnx9_rr0000gr/T//Rtmp15aUhe/file13e7f24ccb17d.png... done!</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Making output_file directories</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $images</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;/private/var/folders/1s/wrtqcpxn685_zk570bnx9_rr0000gr/T/Rtmp15aUhe/file13e7f7a98986a_files/slide_00001.png&quot;</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2] &quot;/private/var/folders/1s/wrtqcpxn685_zk570bnx9_rr0000gr/T/Rtmp15aUhe/file13e7f7a98986a_files/slide_00002.png&quot;</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $script</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Sometimes it’s hard for an instructor to take the time to record their lectures.  For example, I’m in a coffee shop and it may be loud.&quot;</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2] &quot;Here is an example of a plot with really small axes.  We plot the x versus the y-variables and a smoother between them.&quot;</span></span></code></pre></div>
<p>This can be passed to <code>ari_spin</code>.</p>
<p>For Google Slides, the slide deck can be downloaded as a PowerPoint and the previous steps can be used, however it can also be downloaded directly as a PDF. We will use the same presentation, but uploaded to Google Slides. The <strong>ariExtra</strong> package has the function <code>gs_to_ari</code> to wrap this functionality (as long as link sharing is turned on), where we can pass the Google identifier:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>gs_doc <span class="ot">=</span> ariExtra<span class="sc">::</span><span class="fu">gs_to_ari</span>(<span class="st">&quot;14gd2DiOCVKRNpFfLrryrGG7D3S8pu9aZ&quot;</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Converting page 1 to /var/folders/1s/wrtqcpxn685_zk570bnx9_rr0000gr/T//Rtmp15aUhe/file13e7f7e5548d9.png... done!</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Converting page 2 to /var/folders/1s/wrtqcpxn685_zk570bnx9_rr0000gr/T//Rtmp15aUhe/file13e7f1121df5b.png... done!</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>gs_doc[<span class="fu">c</span>(<span class="st">&quot;images&quot;</span>, <span class="st">&quot;script&quot;</span>)]</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $images</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;/private/var/folders/1s/wrtqcpxn685_zk570bnx9_rr0000gr/T/Rtmp15aUhe/file13e7f46ced826_files/slide_00001.png&quot;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2] &quot;/private/var/folders/1s/wrtqcpxn685_zk570bnx9_rr0000gr/T/Rtmp15aUhe/file13e7f46ced826_files/slide_00002.png&quot;</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $script</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;Sometimes it’s hard for an instructor to take the time to record their lectures.  For example, I’m in a coffee shop and it may be loud.&quot;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2] &quot;Here is an example of a plot with really small axes.  We plot the x versus the y-variables and a smoother between them.&quot;</span></span></code></pre></div>
<p>Note, as Google provides a PDF version of the slides, this obviates the LibreOffice dependency.</p>
<p>Alternatively, the notes can be extracted using <strong><code>rgoogleslides</code></strong> and for Google Slides via the API, but requires authentication, so we will omit it here. Thus, we should be able to create videos using R Markdown, Google Slides, or PowerPoint presentations in an automatic fashion.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
